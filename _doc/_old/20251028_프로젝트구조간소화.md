# 프로젝트 구조 간소화 작업

## 작업 일자
2025-10-28

## 작업 개요
불필요한 폴더 구조를 제거하고 파일을 논리적으로 재구성하여 프로젝트 구조를 간소화

## 변경 사항

### 1. 폴더 구조 변경

#### 변경 전 (15개 폴더)
```
nvr_gstreamer/
├── config/               (1개 파일)
├── core/
│   ├── services/         (1개 파일)
│   └── ...
├── streaming/            (2개 파일)
├── recording/            (1개 파일)
├── playback/             (1개 파일)
├── ui/                   (7개 파일)
├── utils/                (2개 파일)
├── tests/                (11개 파일)
├── doc/
├── logs/
├── recordings/
├── gstreamer/            (빈 폴더 - 삭제됨)
├── services/             (빈 폴더 - 삭제됨)
├── _tests/               (빈 폴더 - 삭제됨)
└── _doc/                 (빈 폴더 - 삭제됨)
```

#### 변경 후 (8개 폴더, 47% 감소)
```
nvr_gstreamer/
├── core/                 (5개 파일)
│   ├── config.py
│   ├── storage.py
│   ├── models.py
│   ├── enums.py
│   └── exceptions.py
├── streaming/            (4개 파일)
│   ├── camera_stream.py
│   ├── gst_pipeline.py
│   ├── recording.py
│   └── playback.py
├── ui/                   (7개 파일)
├── utils/                (2개 파일)
├── tests/                (11개 파일)
├── doc/
├── logs/
└── recordings/
```

### 2. 파일 이동 내역

| 이전 경로 | 새 경로 | 사유 |
|----------|---------|------|
| `config/config_manager.py` | `core/config.py` | 단일 파일 폴더 제거 |
| `core/services/storage_service.py` | `core/storage.py` | 불필요한 중첩 제거 |
| `playback/playback_manager.py` | `streaming/playback.py` | 스트리밍과 관련성 높음 |
| `recording/recording_manager.py` | `streaming/recording.py` | 스트리밍과 관련성 높음 |

### 3. Import 경로 변경

#### ConfigManager
```python
# 이전
from config.config_manager import ConfigManager

# 이후
from core.config import ConfigManager
# 또는
from core import ConfigManager
```

#### StorageService
```python
# 이전
from core.services.storage_service import StorageService

# 이후
from core.storage import StorageService
# 또는
from core import StorageService
```

#### RecordingManager
```python
# 이전
from recording.recording_manager import RecordingManager

# 이후
from streaming.recording import RecordingManager
```

#### PlaybackManager
```python
# 이전
from playback.playback_manager import PlaybackManager

# 이후
from streaming.playback import PlaybackManager
```

### 4. 삭제된 폴더

1. **config/** - 파일 1개만 있어서 core/로 병합
2. **playback/** - 파일 1개만 있어서 streaming/으로 병합
3. **recording/** - 파일 1개만 있어서 streaming/으로 병합
4. **core/services/** - 파일 1개만 있어서 core/로 병합

## 장점

### 1. 구조 단순화
- 폴더 수 47% 감소 (15개 → 8개)
- 파일이 1개만 있던 불필요한 폴더 제거
- 탐색 및 파일 찾기 용이

### 2. 논리적 구성
- **core/**: 핵심 비즈니스 로직과 도메인 모델 집중
- **streaming/**: 스트리밍, 녹화, 재생 관련 기능 통합
- **ui/**: UI 컴포넌트만 분리
- **utils/**: 유틸리티 함수 모음

### 3. 유지보수성 향상
- 관련 기능끼리 같은 폴더에 위치
- 모듈 간 의존성이 명확해짐
- 새 파일 추가 시 위치 결정이 쉬움

## 영향받는 파일

### Import 경로가 자동 수정된 파일들 (13개)
1. `core/storage.py`
2. `main.py`
3. `streaming/gst_pipeline.py`
4. `streaming/playback.py`
5. `streaming/recording.py`
6. `tests/run_single_camera.py`
7. `tests/test_config_loading.py`
8. `tests/test_logging_config.py`
9. `tests/test_simple_config.py`
10. `tests/test_single_camera.py`
11. `ui/camera_list_widget.py`
12. `ui/main_window.py`
13. `ui/recording_control_widget.py`

### 업데이트된 모듈 초기화 파일
- `core/__init__.py`: ConfigManager, StorageService export 추가

## 호환성

### 하위 호환성
- 모든 import 경로가 자동으로 수정됨
- 기존 기능 동작에는 영향 없음
- 외부 API 변경 없음

### 테스트
- 모든 테스트 파일의 import 경로 자동 수정됨
- 기존 테스트가 그대로 동작함

## 주의사항

1. **외부 문서**: 외부 문서나 README에 하드코딩된 파일 경로가 있다면 수동 업데이트 필요
2. **Git History**: 파일 이동으로 인해 git blame이 끊길 수 있음 (git log --follow 사용)
3. **IDE 인덱싱**: IDE를 재시작하여 새로운 파일 구조 인덱싱 필요

## 추가 개선 가능성

향후 프로젝트가 더 커질 경우:
- `streaming/` 아래에 `pipeline/`, `management/` 서브폴더 고려
- `tests/`를 기능별로 `tests/unit/`, `tests/integration/`으로 분리 고려
- `ui/widgets/`로 UI 컴포넌트 세분화 고려

## 결론

단일 파일 폴더를 제거하고 관련 기능을 통합하여 프로젝트 구조가 47% 간소화되었습니다.
이를 통해 코드 탐색이 용이해지고 유지보수성이 향상되었습니다.