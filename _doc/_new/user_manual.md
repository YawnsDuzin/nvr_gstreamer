# NVR GStreamer 사용자 메뉴얼

## 목차
1. [시스템 개요](#시스템-개요)
2. [주요 기능](#주요-기능)
3. [시스템 요구사항](#시스템-요구사항)
4. [설치 가이드](#설치-가이드)
5. [프로그램 실행](#프로그램-실행)
6. [화면 구성](#화면-구성)
7. [카메라 관리](#카메라-관리)
8. [녹화 기능](#녹화-기능)
9. [재생 기능](#재생-기능)
10. [PTZ 카메라 제어](#ptz-카메라-제어)
11. [시스템 설정](#시스템-설정)
12. [백업 및 저장공간 관리](#백업-및-저장공간-관리)
13. [단축키](#단축키)
14. [문제 해결](#문제-해결)

---

## 시스템 개요

**NVR GStreamer**는 Python 기반의 네트워크 비디오 녹화 시스템(NVR)으로, RTSP 카메라의 실시간 영상을 모니터링하고 녹화할 수 있는 소프트웨어입니다.

### 주요 특징
- **실시간 스트리밍**: RTSP 프로토콜을 통한 IP 카메라 실시간 모니터링
- **연속 녹화**: 자동 파일 분할 기능을 통한 24시간 연속 녹화
- **재생 기능**: 녹화된 영상의 검색 및 재생
- **PTZ 제어**: 팬/틸트/줌 기능을 가진 카메라 원격 제어
- **자동 재연결**: 네트워크 끊김 시 자동 재연결
- **저사양 최적화**: 라즈베리파이 등 임베디드 장치에서도 안정적 동작 (CPU 사용량 약 50% 절감)

---

## 주요 기능

### 1. 다중 카메라 지원
- 여러 대의 IP 카메라 동시 모니터링
- 카메라별 독립적인 녹화 설정
- 그리드 레이아웃을 통한 화면 분할

### 2. 스마트 녹화
- **자동 녹화**: 카메라 연결 시 자동으로 녹화 시작
- **수동 녹화**: 사용자가 원하는 시점에 녹화 시작/중지
- **파일 자동 분할**: 설정된 시간 단위로 파일 자동 분할 (기본 10분)
- **저장공간 자동 관리**: 디스크 용량 부족 시 오래된 파일 자동 삭제

### 3. 재생 시스템
- 날짜/시간별 녹화 파일 검색
- 재생 속도 조절 (0.5x ~ 2x)
- 타임라인 네비게이션

### 4. PTZ 카메라 제어
- 팬(Pan) / 틸트(Tilt) 방향 제어
- 줌 인/아웃
- 키보드 단축키를 통한 빠른 조작

### 5. 시스템 모니터링
- CPU, 메모리, 온도 실시간 모니터링
- 저장공간 사용량 확인
- 카메라 연결 상태 실시간 표시

---

## 시스템 요구사항

### 하드웨어
- **최소 사양**
  - CPU: 1GHz 듀얼 코어 이상
  - RAM: 1GB 이상
  - 저장공간: 32GB 이상 (녹화 용량에 따라 추가 필요)
  - 네트워크: 100Mbps 이더넷

- **권장 사양**
  - CPU: 1.5GHz 쿼드 코어 이상
  - RAM: 2GB 이상
  - 저장공간: 500GB 이상 (SSD 권장)
  - 네트워크: 기가비트 이더넷

- **지원 플랫폼**
  - Raspberry Pi (3, 4, Zero 2W) - **주 개발 대상**
  - Ubuntu 20.04 이상
  - Debian 11 이상
  - Windows 10/11 (실험적 지원)

### 소프트웨어
- Python 3.8 이상
- GStreamer 1.18 이상
- PyQt5
- 네트워크 연결 (RTSP 카메라 접근용)

---

## 설치 가이드

### Linux / Raspberry Pi

#### 1. 시스템 패키지 설치
```bash
# 시스템 업데이트
sudo apt-get update
sudo apt-get upgrade

# GStreamer 및 필수 플러그인 설치
sudo apt-get install -y \
    gstreamer1.0-tools \
    gstreamer1.0-plugins-base \
    gstreamer1.0-plugins-good \
    gstreamer1.0-plugins-bad \
    gstreamer1.0-plugins-ugly \
    gstreamer1.0-libav \
    python3-gi python3-gi-cairo \
    gir1.2-gstreamer-1.0 \
    gir1.2-gst-plugins-base-1.0
```

#### 2. 라즈베리파이 하드웨어 가속 (선택사항)
```bash
# 라즈베리파이 3 및 이전 모델
sudo apt-get install -y gstreamer1.0-omx-generic

# 라즈베리파이 4 및 최신 모델
sudo apt-get install -y libv4l-0 v4l-utils
```

#### 3. Python 패키지 설치
```bash
# 프로젝트 디렉토리로 이동
cd nvr_gstreamer

# Python 의존성 설치
pip install -r requirements.txt
```

### Windows

#### 1. GStreamer 설치
1. [GStreamer 공식 웹사이트](https://gstreamer.freedesktop.org/download/) 방문
2. Windows용 설치 파일 다운로드 (Complete 버전 권장)
3. 설치 후 시스템 환경변수 PATH에 GStreamer bin 디렉토리 추가
   - 기본 경로: `C:\gstreamer\1.0\x86_64\bin`

#### 2. Python 패키지 설치
```bash
# requirements.txt에서 PyQt6를 PyQt5로 변경
# (편집기로 requirements.txt 열어서 PyQt6 → PyQt5 수정)

# Python 의존성 설치
pip install -r requirements.txt
```

---

## 프로그램 실행

### 기본 실행
```bash
# GUI 모드로 실행
python main.py

# 디버그 모드 (로그 출력 포함)
python main.py --debug

# 사용자 지정 설정 파일 사용
python main.py --config custom_config.json
```

### 테스트 모드
```bash
# 단일 카메라 테스트 (헤드리스 모드 - GUI 없이 녹화만)
python _tests/run_single_camera.py --headless --debug

# 단일 카메라 테스트 (자동 녹화 시작)
python _tests/run_single_camera.py --recording

# 설정 파일 검증
python _tests/test_config_loading.py
```

---

## 화면 구성

프로그램 실행 시 메인 화면은 다음과 같이 구성됩니다:

```
┌─────────────────────────────────────────────────────────────┐
│  메뉴바: 파일 | 보기 | 설정 | 도움말                         │
├─────────────┬───────────────────────────────┬───────────────┤
│             │                               │               │
│  카메라     │      비디오 그리드            │  녹화 제어    │
│  목록       │      (카메라 영상 표시)       │  패널         │
│             │                               │               │
│  - Cam 01   │   ┌─────────────────────┐     │  ● 녹화 시작  │
│  - Cam 02   │   │                     │     │  ■ 녹화 중지  │
│  - Cam 03   │   │  실시간 영상 표시   │     │               │
│             │   │                     │     │  카메라: Cam01│
│             │   └─────────────────────┘     │  상태: 녹화중 │
│             │                               │  시간: 00:15:32│
│             │                               │               │
├─────────────┴───────────────────────────────┴───────────────┤
│                                                               │
│  재생 패널                                                    │
│  날짜: [2025-11-13]  카메라: [Cam 01]  [◀] [▶] [■]          │
│  ├────────────────────────────────────────────────┤          │
│  00:00                                       23:59           │
└─────────────────────────────────────────────────────────────┘
```

### 주요 영역 설명

1. **메뉴바**: 파일, 보기, 설정 등 주요 기능 접근
2. **카메라 목록 (좌측)**: 등록된 카메라 목록 및 상태 표시
3. **비디오 그리드 (중앙)**: 카메라 실시간 영상 표시
4. **녹화 제어 패널 (우측)**: 녹화 시작/중지 및 상태 확인
5. **재생 패널 (하단)**: 녹화 파일 검색 및 재생

---

## 카메라 관리

### 카메라 추가

1. **메뉴 → 설정 → 환경설정** 클릭
2. **카메라** 탭 선택
3. **카메라 추가** 버튼 클릭
4. 다음 정보 입력:
   - **카메라 ID**: 고유 식별자 (예: `cam_01`, `camera_front`)
   - **카메라 이름**: 표시될 이름 (예: `현관`, `주차장`)
   - **RTSP URL**: 카메라 스트림 주소
     ```
     rtsp://192.168.1.100:554/stream1
     rtsp://admin:password@192.168.1.100:554/h264/ch1/main/av_stream
     ```
   - **사용자명 / 비밀번호**: 카메라 인증 정보 (선택사항)
   - **시작 시 자동 녹화**: 체크 시 프로그램 시작과 동시에 녹화 시작

5. **확인** 버튼 클릭

### RTSP URL 확인 방법
- 카메라 제조사 매뉴얼 참조
- 주요 제조사별 기본 URL 형식:
  - **Hikvision**: `rtsp://admin:password@IP:554/Streaming/Channels/101`
  - **Dahua**: `rtsp://admin:password@IP:554/cam/realmonitor?channel=1&subtype=0`
  - **일반 ONVIF**: `rtsp://IP:554/stream1`

### 카메라 수정/삭제

1. 카메라 목록에서 카메라 우클릭
2. **수정** 또는 **삭제** 선택
3. 수정 시: 정보 변경 후 **확인**
4. 삭제 시: 확인 대화상자에서 **예** 클릭

### 카메라 연결 상태

카메라 목록에서 각 카메라의 연결 상태를 실시간으로 확인할 수 있습니다:
- 🟢 **녹색**: 정상 연결 및 스트리밍 중
- 🟡 **노란색**: 연결 시도 중
- 🔴 **빨간색**: 연결 실패 또는 오류
- 🔵 **파란색**: 재연결 시도 중

### 자동 재연결
- 네트워크 문제로 카메라 연결이 끊어진 경우, 자동으로 재연결 시도
- 재연결 시 새로운 녹화 파일이 생성됨
- 최대 재연결 시도 횟수 및 간격은 설정에서 조정 가능

---

## 녹화 기능

### 자동 녹화

1. **카메라 설정**에서 **"시작 시 자동 녹화"** 옵션 활성화
2. 프로그램 실행 시 자동으로 녹화 시작
3. 카메라 연결이 끊어졌다가 다시 연결되면 자동으로 녹화 재개

### 수동 녹화

1. **녹화 제어 패널**에서 녹화할 카메라 선택
2. **녹화 시작** 버튼 (●) 클릭
3. 녹화 중지 시: **녹화 중지** 버튼 (■) 클릭

### 녹화 파일 관리

#### 파일 저장 위치
```
recordings/
├── cam_01/
│   ├── 2025-11-13/
│   │   ├── cam_01_20251113_090000.mp4
│   │   ├── cam_01_20251113_091000.mp4
│   │   └── cam_01_20251113_092000.mp4
│   └── 2025-11-14/
│       └── ...
└── cam_02/
    └── ...
```

- 카메라별로 폴더 구분
- 날짜별로 하위 폴더 생성
- 파일명 형식: `{카메라ID}_{날짜}_{시간}.mp4`

#### 파일 자동 분할
- 기본 설정: **10분 단위**로 파일 자동 분할
- 설정 변경: **메뉴 → 설정 → 환경설정 → 녹화** 탭
  - **파일 분할 시간**: 1~60분 설정 가능
  - 연속 녹화 시 자동으로 다음 파일 생성

#### 자동 삭제 정책
저장공간 관리를 위한 자동 삭제 기능:
1. **일자 기반 삭제**: 설정된 일수(기본 30일)보다 오래된 파일 자동 삭제
2. **용량 기반 삭제**: 디스크 여유 공간이 설정값(기본 10GB) 이하로 떨어지면 가장 오래된 파일부터 삭제

설정 변경: **메뉴 → 설정 → 환경설정 → 저장공간** 탭

---

## 재생 기능

### 녹화 파일 재생

1. **재생 패널** 활성화 (하단 또는 독립 창)
2. **날짜 선택**: 달력 아이콘 클릭하여 원하는 날짜 선택
3. **카메라 선택**: 드롭다운 메뉴에서 카메라 선택
4. **파일 목록 확인**: 선택한 날짜/카메라의 녹화 파일 목록 표시
5. **재생**: 원하는 파일을 더블클릭하거나 재생 버튼 (▶) 클릭

### 재생 컨트롤

```
◀ 이전 파일    ▶ 재생/일시정지    ■ 정지    ▶▶ 다음 파일
├──────────────────────────────────────────────┤ 타임라인
00:00                                      10:00

속도: [0.5x] [1.0x] [1.5x] [2.0x]
음소거: [🔇]  볼륨: ├────────┤
```

- **재생/일시정지**: 스페이스바 또는 ▶ 버튼
- **정지**: ■ 버튼
- **이전/다음 파일**: ◀ / ▶▶ 버튼
- **타임라인**: 드래그하여 원하는 시점으로 이동
- **재생 속도**: 0.5배속 ~ 2배속 선택
- **음소거/볼륨**: 음량 조절 및 음소거

### 타임라인 검색

1. **타임라인 바**에서 원하는 시간대 클릭
2. 해당 시점부터 재생 시작
3. 마우스 드래그로 빠른 검색 가능

---

## PTZ 카메라 제어

PTZ(Pan-Tilt-Zoom) 기능을 지원하는 카메라의 경우, 원격으로 카메라 방향과 줌을 조절할 수 있습니다.

### PTZ 카메라 설정

1. **메뉴 → 설정 → 환경설정 → 카메라** 탭
2. PTZ 카메라 선택 후 **수정**
3. **PTZ 설정** 섹션:
   - **PTZ 타입**: HIK 또는 ONVIF 선택
   - **PTZ 포트**: 제어 포트 (기본값: 8000)
   - **PTZ 채널**: 카메라 채널 번호 (기본값: 1)
4. **확인** 클릭

### PTZ 제어 방법

#### 키보드 단축키 (기본 설정)
- **방향 제어**:
  - `↑` / `↓` / `←` / `→`: 상/하/좌/우 이동
  - `Home` / `End` / `PgUp` / `PgDn`: 대각선 이동
- **줌 제어**:
  - `V`: 줌 인 (확대)
  - `B`: 줌 아웃 (축소)
- **속도 조절**:
  - `+` / `-`: 이동 속도 증가/감소

#### 마우스 제어 (선택사항)
- 비디오 화면에서 PTZ 제어 패널 활성화
- 방향 버튼 및 줌 슬라이더 사용

### PTZ 단축키 사용자 지정

1. **메뉴 → 설정 → 환경설정 → PTZ 키** 탭
2. 변경하려는 기능 선택
3. 새로운 키 입력
4. **확인** 클릭

---

## 시스템 설정

### 환경설정 접근
**메뉴 → 설정 → 환경설정** 또는 `F2` 키

### 주요 설정 탭

#### 1. 기본 설정
- **언어**: 인터페이스 언어 (한국어/English)
- **로그 레벨**: DEBUG, INFO, WARNING, ERROR
- **시작 옵션**:
  - 전체화면으로 시작
  - 시스템 트레이에 최소화

#### 2. 카메라 설정
- 카메라 추가/수정/삭제
- RTSP URL 및 인증 정보
- PTZ 설정
- 비디오 변환 (회전, 뒤집기)

#### 3. 스트리밍 설정
- **버퍼 크기**: 네트워크 지연 보상 (기본: 2000ms)
- **재연결 설정**:
  - 재연결 시도 횟수 (기본: 10회)
  - 재연결 간격 (기본: 5초)
- **하드웨어 가속**:
  - 자동 감지
  - 강제 활성화/비활성화

#### 4. 녹화 설정
- **파일 형식**: MP4, MKV
- **파일 분할 시간**: 1~60분 (기본: 10분)
- **비디오 코덱**: H.264, H.265
- **품질 설정**: 비트레이트, 해상도

#### 5. 저장공간 설정
- **녹화 경로**: 녹화 파일 저장 위치
- **자동 삭제**:
  - 보관 기간 (일 단위)
  - 최소 여유 공간 (GB)
- **저장공간 모니터링**: 경고 임계값 설정

#### 6. 백업 설정
- **백업 경로**: 백업 파일 저장 위치
- **자동 백업**: 스케줄 설정
- **백업 옵션**:
  - MD5 해시 검증
  - 백업 후 원본 삭제

#### 7. 성능 설정
- **시스템 모니터링 임계값**:
  - CPU 사용률 경고 (기본: 80%)
  - 메모리 사용률 경고 (기본: 85%)
  - 온도 경고 (기본: 70°C)
- **모니터링 간격**: 1~60초

#### 8. 로깅 설정
- **로그 출력 위치**:
  - 콘솔 출력
  - 파일 저장 (경로 지정)
  - JSON 형식 로그
- **로그 보관 기간**

#### 9. 단축키 설정
- **메뉴 키**: F1~F12 매핑
- **PTZ 키**: 방향/줌 제어 키 매핑

---

## 백업 및 저장공간 관리

### 수동 백업

1. **재생 패널**에서 백업할 파일 선택
2. 우클릭 → **백업** 메뉴 선택
3. 백업 대화상자에서 옵션 설정:
   - 백업 경로 선택
   - MD5 검증 활성화 (권장)
   - 백업 후 원본 삭제 (선택)
4. **백업 시작** 클릭
5. 진행 상황 모니터링
6. 완료 시 결과 확인

### 자동 백업 설정

1. **메뉴 → 설정 → 환경설정 → 백업** 탭
2. **자동 백업 활성화** 체크
3. **스케줄 설정**:
   - 백업 시작 시간 (예: 매일 02:00)
   - 백업 대상 (전일 녹화 파일 등)
4. **백업 경로** 지정
5. **확인** 클릭

### 저장공간 확인

#### 상태 바
메인 화면 하단 상태 바에서 실시간 확인:
```
저장공간: 250GB / 500GB (50% 사용)  |  카메라: 3/3 연결  |  CPU: 45%  |  메모리: 1.2GB
```

#### 상세 정보
1. **메뉴 → 보기 → 시스템 상태**
2. 저장공간 탭에서 확인:
   - 전체 용량 / 사용 중 / 여유 공간
   - 카메라별 사용 공간
   - 예상 녹화 가능 시간

### 수동 파일 삭제

1. **재생 패널**에서 삭제할 파일 선택
2. 우클릭 → **삭제** 메뉴 선택 또는 `Delete` 키
3. 확인 대화상자에서 **예** 클릭
4. 진행 상황 표시 (대용량 파일의 경우)

---

## 단축키

### 전역 단축키

| 키 | 기능 |
|---|---|
| `F1` | 도움말 |
| `F2` | 환경설정 |
| `F5` | 화면 새로고침 |
| `F11` | 전체화면 토글 |
| `Ctrl + Q` | 프로그램 종료 |
| `Ctrl + R` | 녹화 시작/중지 |
| `Ctrl + P` | 재생 패널 토글 |
| `Ctrl + L` | 로그 뷰어 |

### PTZ 제어 (기본값)

| 키 | 기능 |
|---|---|
| `↑` `↓` `←` `→` | 카메라 이동 (상/하/좌/우) |
| `Home` `End` `PgUp` `PgDn` | 대각선 이동 |
| `V` | 줌 인 |
| `B` | 줌 아웃 |
| `+` `-` | 이동 속도 조절 |

### 재생 제어

| 키 | 기능 |
|---|---|
| `Space` | 재생/일시정지 |
| `Enter` | 선택한 파일 재생 |
| `Esc` | 재생 중지 |
| `→` | 10초 앞으로 |
| `←` | 10초 뒤로 |
| `↑` | 음량 증가 |
| `↓` | 음량 감소 |
| `M` | 음소거 |

### 단축키 변경 방법
**메뉴 → 설정 → 환경설정 → 단축키** 탭에서 사용자 정의 가능

---

## 문제 해결

### 카메라가 연결되지 않아요

#### 1. RTSP URL 확인
```bash
# 터미널에서 카메라 연결 테스트
ffplay rtsp://192.168.1.100:554/stream1

# 또는
gst-launch-1.0 rtspsrc location=rtsp://192.168.1.100:554/stream1 ! fakesink
```

#### 2. 네트워크 연결 확인
```bash
# 카메라 IP 핑 테스트
ping 192.168.1.100

# 포트 확인
nc -zv 192.168.1.100 554
```

#### 3. 인증 정보 확인
- 카메라 사용자명/비밀번호가 올바른지 확인
- URL에 인증 정보 포함: `rtsp://admin:password@IP:554/stream`

#### 4. 방화벽 확인
- RTSP 포트(기본 554) 방화벽 허용 확인
- 라우터 포트 포워딩 설정 확인 (외부 네트워크 접근 시)

### 녹화 파일이 생성되지 않아요

#### 1. 저장 경로 확인
- **메뉴 → 설정 → 환경설정 → 저장공간** 탭
- 녹화 경로가 올바르게 설정되어 있는지 확인
- 해당 경로에 쓰기 권한이 있는지 확인
  ```bash
  ls -ld /path/to/recordings
  # drwxrwxr-x 형태로 쓰기 권한 확인
  ```

#### 2. 디스크 공간 확인
```bash
df -h /path/to/recordings
# 충분한 여유 공간이 있는지 확인
```

#### 3. 녹화 설정 확인
- **녹화 제어 패널**에서 녹화가 실제로 시작되었는지 확인
- 녹화 상태 표시등이 켜져 있는지 확인

#### 4. 로그 확인
```bash
# 디버그 모드로 실행하여 오류 확인
python main.py --debug

# 로그 파일 확인 (로그 저장이 활성화된 경우)
cat _logs/nvr_*.log
```

### 녹화 파일이 재생되지 않아요

#### 1. 파일 크기 확인
- 0 바이트 파일: 녹화가 제대로 완료되지 않음
- 해결: 파일 분할 시간 간격 확인 및 수동 녹화 중지 대신 자동 분할 사용

#### 2. 코덱 확인
```bash
# 파일 정보 확인
ffprobe recording_file.mp4

# 또는
gst-discoverer-1.0 recording_file.mp4
```

#### 3. 미디어 플레이어 확인
- VLC, MPV 등 다양한 플레이어로 테스트
- 프로그램 내장 플레이어로 재생 시도

#### 4. 파일 손상
- 녹화 중 프로그램이 비정상 종료된 경우 파일 손상 가능
- 복구 시도:
  ```bash
  ffmpeg -i damaged.mp4 -c copy repaired.mp4
  ```

### 영상이 끊겨요 (버퍼링)

#### 1. 네트워크 대역폭 확인
- 다수의 카메라 동시 스트리밍 시 네트워크 부하 증가
- 해결: 카메라 해상도/비트레이트 낮추기

#### 2. CPU 사용률 확인
- **상태 바** 또는 **시스템 상태** 창에서 CPU 사용률 확인
- 해결:
  - 동시 스트리밍 카메라 수 줄이기
  - 하드웨어 가속 활성화 (라즈베리파이의 경우)

#### 3. 버퍼 크기 조정
- **메뉴 → 설정 → 환경설정 → 스트리밍** 탭
- 버퍼 크기 증가 (예: 2000ms → 5000ms)

#### 4. 하드웨어 가속 활성화
- **메뉴 → 설정 → 환경설정 → 스트리밍** 탭
- **하드웨어 가속 활성화** 체크
- 프로그램 재시작

### PTZ 제어가 작동하지 않아요

#### 1. PTZ 설정 확인
- **메뉴 → 설정 → 환경설정 → 카메라** 탭
- PTZ 타입, 포트, 채널 번호가 올바른지 확인

#### 2. 카메라 선택 확인
- PTZ 제어 전 반드시 해당 카메라를 선택해야 함
- 비디오 화면 클릭 또는 카메라 목록에서 선택

#### 3. 네트워크 포트 확인
```bash
# PTZ 제어 포트 연결 확인 (HIK 기본 8000번 포트)
nc -zv 192.168.1.100 8000
```

#### 4. 카메라 호환성 확인
- 카메라가 HIK 또는 ONVIF 프로토콜을 지원하는지 확인
- 카메라 설정에서 PTZ 기능이 활성화되어 있는지 확인

### 프로그램이 느려요

#### 1. 시스템 리소스 확인
```bash
# CPU, 메모리 사용률 확인
top
htop

# 라즈베리파이 온도 확인
vcgencmd measure_temp
```

#### 2. 최적화 방법
- **동시 스트리밍 카메라 수 줄이기**: 필요한 카메라만 활성화
- **해상도 낮추기**: 카메라 설정에서 서브스트림 사용
- **녹화 비트레이트 조정**: 불필요하게 높은 화질 사용하지 않기
- **자동 삭제 정책 활성화**: 오래된 파일로 인한 디스크 I/O 부하 감소

#### 3. 데이터베이스 최적화
```bash
# SQLite 데이터베이스 최적화 (주기적 실행 권장)
sqlite3 IT_RNVR.db "VACUUM;"
```

#### 4. 로그 파일 정리
```bash
# 오래된 로그 파일 삭제
find _logs -name "*.log" -mtime +30 -delete
```

### 라즈베리파이에서 BadWindow 오류가 발생해요

- **원인**: X Window 시스템 호환성 문제
- **해결**: 프로그램이 자동으로 감지하여 헤드리스 모드로 전환
- 녹화 기능은 정상 작동하며, 웹 브라우저를 통한 원격 모니터링 가능 (별도 설정 필요)

### 설정이 저장되지 않아요

#### 1. 데이터베이스 파일 권한 확인
```bash
ls -l IT_RNVR.db
# 쓰기 권한이 있는지 확인
```

#### 2. 데이터베이스 무결성 확인
```bash
sqlite3 IT_RNVR.db "PRAGMA integrity_check;"
# 결과가 "ok"가 아니면 데이터베이스 손상
```

#### 3. 백업에서 복원
```bash
# 데이터베이스 백업 파일이 있는 경우
cp IT_RNVR.db.backup IT_RNVR.db
```

### 프로그램이 시작되지 않아요

#### 1. Python 버전 확인
```bash
python --version
# Python 3.8 이상이어야 함
```

#### 2. 의존성 확인
```bash
# 필수 패키지 설치 확인
pip list | grep -E "PyQt5|gi"
```

#### 3. GStreamer 설치 확인
```bash
# GStreamer 버전 확인
gst-launch-1.0 --version
# 1.18 이상이어야 함
```

#### 4. 로그 확인
```bash
# 디버그 모드로 실행하여 오류 메시지 확인
python main.py --debug
```

---

## 추가 지원

### 로그 수집
문제 발생 시 다음 정보를 수집하여 개발자에게 전달:

1. **디버그 로그**:
   ```bash
   python main.py --debug > debug_output.txt 2>&1
   ```

2. **시스템 정보**:
   ```bash
   # Linux/Raspberry Pi
   uname -a
   cat /proc/cpuinfo | grep Model
   python --version
   gst-launch-1.0 --version

   # Windows
   systeminfo
   python --version
   ```

3. **설정 파일**: `IT_RNVR.db` (개인정보 제거 후)

4. **에러 스크린샷**: 오류 메시지 화면 캡처

### 개발자 문의
- **GitHub Issues**: [프로젝트 저장소 URL]
- **이메일**: [담당자 이메일]
- **문서**: `./_doc/` 폴더의 기술 문서 참조

### 추가 문서
- **개발자 가이드**: `CLAUDE.md`
- **기술 문서**: `_doc/` 폴더
- **테스트 스크립트**: `_tests/` 폴더

---

## 부록

### 용어 설명

- **NVR (Network Video Recorder)**: 네트워크 기반 비디오 녹화 시스템
- **RTSP (Real Time Streaming Protocol)**: 실시간 스트리밍 프로토콜
- **PTZ (Pan-Tilt-Zoom)**: 카메라의 방향(팬/틸트)과 줌을 제어하는 기능
- **GStreamer**: 멀티미디어 프레임워크 (비디오 처리 엔진)
- **Pipeline**: GStreamer의 비디오 처리 흐름
- **Codec**: 비디오/오디오 압축 방식 (H.264, H.265 등)
- **Bitrate**: 초당 전송되는 데이터 양 (비트레이트가 높을수록 화질 좋음)

### 권장 카메라 사양

- **프로토콜**: RTSP 지원
- **코덱**: H.264 (H.265 선택사항)
- **해상도**: 1080p (1920x1080) 권장
- **프레임레이트**: 15~30 FPS
- **PTZ**: ONVIF 또는 HIK 프로토콜 지원 (PTZ 기능 사용 시)

### 네트워크 구성 예시

```
[인터넷] ─── [라우터] ─┬─ [NVR 서버 (라즈베리파이)]
                      ├─ [IP 카메라 1] 192.168.1.101
                      ├─ [IP 카메라 2] 192.168.1.102
                      └─ [IP 카메라 3] 192.168.1.103
```

- **권장**: 유선 랜(기가비트 이더넷)
- **대역폭 계산**: 카메라당 약 2~8 Mbps (해상도/비트레이트에 따라)
- **스위치**: 관리형 스위치 권장 (QoS 설정 가능)

---

**문서 버전**: 1.0
**최종 수정일**: 2025-11-13
**작성자**: NVR GStreamer Development Team
